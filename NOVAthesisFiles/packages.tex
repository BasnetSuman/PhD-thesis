%!TEX root = ../template.tex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% packages.tex
%% NOVA thesis configuration file
%%
%% Packages to be loaded
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\typeout{NT LOADING FILE packages.tex}

\ifxetexorluatex
  % xelatex or lualatex
  \RequirePackage{fontspec}%
  \defaultfontfeatures{Ligatures=TeX}
\else% pdflatex
  %%%%% Configure font encoding
  \RequirePackage[T1]{fontenc}		% Use new T1 fonts

  %%%%% Configure input encoding
  \RequirePackage[utf8]{inputenc}		% Format for the input file(s), see the "enc" option
\fi

%%%%% Configure multilingual language support
\RequirePackage{csquotes}
\RequirePackage{babel}			% Support for bilingual documents

% \RequirePackage{appendix}


%%%%% Fine tuning of typesetting
\ifxeorlua{}{% pdflatex
  \RequirePackage[%
    babel=true,
    activate={true,nocompatibility},  % activate={true,nocompatibility} - activate protrusion and expansion
    final,            % final - enable microtype; use "draft" to disable  
    tracking=true,    % tracking=true - activate this technique
    kerning=true,     % kerning=true - activate this technique
    spacing=true,     % spacing=true - activate this technique
    factor=1100,      % factor=1100 - add 10% to the protrusion amount (default is 1000)
    stretch=10,       % stretch=10 - reduce stretchability (default is 20)
    shrink=10,        % shrink=10 - reduce shrinkability (default is 20)
  ]{microtype}
}

%%%%% Better support for calculations
\RequirePackage{xstring}


% To process lists and other stuff
\RequirePackage{etoolbox}

% To typeset text sideways
% \RequirePackage{lscape}

% To use a wide range of color names
\RequirePackage[svgnames]{xcolor}%


%%%%% LOAD THESE PACKAGES JUST AT THE ENF OF THE PREAMBLE 
%%%%% AND BEFORE THE \BEGIN{DOCUMENT}
% \novathesisAtEndClassFile{%
  %%%%% Configure HyperRefs
  % \RequirePackage[pdftex,usenames]{color}
  % \RequirePackage[pdftex]{xcolor}
  % \RequirePackage[usenames]{color}
  \RequirePackage{colortbl}
  \definecolor{darkblue}{rgb}{0.0,0.08,0.45}%
% }


%%%%% Configure Graphics
\RequirePackage[nobeamer]{graphbox}
\graphicspath{{Chapters/Figures/}}
\DeclareGraphicsExtensions{.pdf, .png, .jpg, .tif}
\newcommand\appendtographicspath[1]{%
  \gappto\Ginput@path{#1}%
}
\newcommand\prependtographicspath[1]{%
  \gpreto\Ginput@path{#1}%
}


% Add an image to the backgroung
% Used to insert the background image in the cover page
\RequirePackage{eso-pic}[2015/04/20]



% Setup of listings, for more information check package manual
\RequirePackage{listings}		% Fontification of source code listings
\lstset{
    captionpos=t,
    basicstyle={\ttfamily\footnotesize},
    numbers=left,
    numberstyle={\ttfamily\tiny},
    tabsize=2,
    language=Java,
    float,
    frame=single,
    columns=fullflexible,
    breaklines=true,
    postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space},
    inputencoding=utf8,
    extendedchars=true,
    literate=
      {á}{{\'a}}1 {é}{{\'e}}1 {í}{{\'i}}1 {ó}{{\'o}}1 {ú}{{\'u}}1
      {Á}{{\'A}}1 {É}{{\'E}}1 {Í}{{\'I}}1 {Ó}{{\'O}}1 {Ú}{{\'U}}1
      {à}{{\`a}}1 {è}{{\`e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ù}{{\`u}}1
      {À}{{\`A}}1 {È}{{\'E}}1 {Ì}{{\`I}}1 {Ò}{{\`O}}1 {Ù}{{\`U}}1
      {ä}{{\"a}}1 {ë}{{\"e}}1 {ï}{{\"i}}1 {ö}{{\"o}}1 {ü}{{\"u}}1
      {Ä}{{\"A}}1 {Ë}{{\"E}}1 {Ï}{{\"I}}1 {Ö}{{\"O}}1 {Ü}{{\"U}}1
      {â}{{\^a}}1 {ê}{{\^e}}1 {î}{{\^i}}1 {ô}{{\^o}}1 {û}{{\^u}}1
      {Â}{{\^A}}1 {Ê}{{\^E}}1 {Î}{{\^I}}1 {Ô}{{\^O}}1 {Û}{{\^U}}1
      {œ}{{\oe}}1 {Œ}{{\OE}}1 {æ}{{\ae}}1 {Æ}{{\AE}}1 {ß}{{\ss}}1
      {ç}{{\c c}}1 {Ç}{{\c C}}1 {ø}{{\o}}1 {å}{{\r a}}1 {Å}{{\r A}}1
      {€}{{\EUR}}1 {£}{{\pounds}}1
}


% Cover design debugging
\RequirePackage[type=none]{fgruler}


% Flexible definition of new environments
\RequirePackage{environ}

\newcommand{\@nt@fixhyperref}{
  \def\HyLang@DeclareLang##1##2##3{%
    \@ifpackagewith{babel}{##1}{%
      \expandafter\HyLang@addto
          \csname extras##1\expandafter\endcsname
          \csname HyLang@##2\endcsname
      \begingroup
        \edef\x{\endgroup
          ##3%
        }%
      \x
      \@namedef{HyLang@##1@done}{}%
    }{% added check for "main=##1" (presumably Heiko can do better)
      \@ifpackagewith{babel}{main=##1}{%
        \expandafter\HyLang@addto
          \csname extras##1\expandafter\endcsname
          \csname HyLang@##2\endcsname
        \begingroup
          \edef\x{\endgroup
            ##3%
          }%
        \x
        \@namedef{HyLang@##1@done}{}%
       }{}%
    }%
    \begingroup
      \edef\x####1####2{%
        \noexpand\ifx####2\relax
          \errmessage{No definitions for language ##2' found!}%
        \noexpand\fi
        \endgroup
        \noexpand\define@key{Hyp}{##1}[]{%
          \noexpand\@ifundefined{HyLang@##1@done}{%
            \noexpand\HyLang@addto{\noexpand####1}{\noexpand####2}%
            ##3%
            \noexpand\@namedef{HyLang@##1@done}{}%
          }{}%
        }%
      }%
    \expandafter\x\csname extras##1\expandafter\endcsname
                  \csname HyLang@##2\endcsname
  }
  % repeat the known language declarations
  \HyLang@DeclareLang{english}{english}{}
  \HyLang@DeclareLang{UKenglish}{english}{}
  \HyLang@DeclareLang{british}{english}{}
  \HyLang@DeclareLang{USenglish}{english}{}
  \HyLang@DeclareLang{american}{english}{}
  \HyLang@DeclareLang{german}{german}{}
  \HyLang@DeclareLang{austrian}{german}{}
  \HyLang@DeclareLang{ngerman}{german}{}
  \HyLang@DeclareLang{naustrian}{german}{}
  \HyLang@DeclareLang{russian}{russian}{\noexpand\hypersetup{unicode}}
  \HyLang@DeclareLang{brazil}{portuges}{}
  \HyLang@DeclareLang{brazilian}{portuges}{}
  \HyLang@DeclareLang{portuguese}{portuges}{}
  \HyLang@DeclareLang{spanish}{spanish}{}
  \HyLang@DeclareLang{afrikaans}{afrikaans}{}
  \HyLang@DeclareLang{french}{french}{}
  \HyLang@DeclareLang{frenchb}{french}{}
  \HyLang@DeclareLang{francais}{french}{}
  \HyLang@DeclareLang{acadian}{french}{}
  \HyLang@DeclareLang{canadien}{french}{}
  \HyLang@DeclareLang{italian}{italian}{}
  \HyLang@DeclareLang{magyar}{magyar}{}
  \HyLang@DeclareLang{hungarian}{magyar}{}
}

\AtEndPreamble{%
  \RequirePackage[%
    , breaklinks%
    , colorlinks=true%
    , pdfdisplaydoctitle%
    , unicode
  ]{hyperref}%
  \@nt@fixhyperref%
  \pdfstringdefDisableCommands{%
    \def\\{}%
    \def\texttt#1{#1}%
  }%
  \RequirePackage{memhfixc}%   Must be used on memoir document class after hyperref
  \RequirePackage[all]{hypcap}%
  % To handle subfigures
  \newsubfloat{figure}%
  % Manage glossaries
  \RequirePackage[
    % , nonumberlist
    , toc%
    , translate=babel%
    , acronym% add acronyms listing
    , symbols% add symbols listing
    % , sanitizesort=false% allow \gls inside descriptions
    % , automake
  ]{glossaries-extra}% To create glossaries
  \RequirePackage{glossary-xltabular}
  \setglossarystyle{xltabular3col}%
  % \setlength{\glsdescwidth}{\linewidth}%
  % \addtolength{\glsdescwidth}{-1em}
  % \setglossarystyle{long}%
  \renewcommand{\glsnamefont}[1]{\textbf{#1}}%
  \makenoidxglossaries% use TeX to sort
}
